<!DOCTYPE html>
<html>
  <head>
    <title>DOGUS Audit js</title>
    <link rel="stylesheet" href="css/main.css">

    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>


    <script type="text/javascript">
    'use strict';

    let api = {
      config: {
        urlId: 'url',
        limitId: 'limit',
        adminMessagesId: 'adminMessages'
      },
      buildUrl: () => {
        let url =  document.getElementById(api.config.urlId).value;
        let limit =  document.getElementById(api.config.limitId).value;
        let urlOut = 'http://localhost:8082/getData/?url=' + url + '&limit=' + limit;
        console.log('url/limit', urlOut);
        return urlOut;
      },
      getPageData: () => {

          let url =  api.buildUrl();
          api.addMessage('Ajax sent to : ' + url);
          axios({
            method:'get',
            url: url,
            responseType:'json'
          })
          .then(function (response) {
            if(response.status === 200){
              console.log('Success 200',response.data);
              let html = response.data;
              api.addMessage('Ajax Success: Success loadedUrl: ' + url);
            } else {
              console.log('getPage called err: ', response);
              api.addMessage('Err not 200: ' + response.status);
            }
          })
          .catch(function (error) {
            console.log('x err',error);
          });
      },
      addMessage: (message) => {
        document.getElementById(api.config.adminMessagesId).innerHTML += '<li>' + message +'</li>';
      }

    };

  //  console.log('config', api.config);


    </script>
  </head>
  <body>
      <form name="control">
          <input id="url" style="width:500px" value="https://www.ibm.com" type="text">
          <input id="limit" value="3" type="number">

          <input type="button" onClick="api.getPageData()" value="getPageData">
      </form>
      <ul id="adminMessages"></ul>
  </body>
</html>
